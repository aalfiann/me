function XMLtoJSON(){this.fromFile=function(e,r){var t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");t.open("GET",e,!1),t.send(null);var n=i(l(t.responseXML));return void 0===r?JSON.parse(n):n},this.fromStr=function(e,r){if(window.DOMParser)var t=(new DOMParser).parseFromString(e,"text/xml");else(t=new ActiveXObject("Microsoft.XMLDOM")).async="false";var n=i(l(t));return void 0===r?JSON.parse(n):n};var l=function(e){var r={};if(1==e.nodeType){if(0<e.attributes.length){r["@attributes"]={};for(var t=0;t<e.attributes.length;t++){var n=e.attributes.item(t);r["@attributes"][n.nodeName]=n.value}}}else 3==e.nodeType&&(r=e.nodeValue);if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var a=e.childNodes.item(i),s=a.nodeName;if(void 0===r[s])r[s]=l(a);else{if(void 0===r[s].push){var o=r[s];r[s]=[],r[s].push(o)}r[s].push(l(a))}}return r},i=function(e){var r=JSON.stringify(e,void 0,2).replace(/(\\t|\\r|\\n)/g,"").replace(/"",[\n\t\r\s]+""[,]*/g,"").replace(/(\n[\t\s\r]*\n)/g,"").replace(/[\s\t]{2,}""[,]{0,1}/g,"").replace(/"[\s\t]{1,}"[,]{0,1}/g,"").replace(/\[[\t\s]*\]/g,'""');return-1==r.indexOf('"parsererror": {')?r:"Invalid XML format"}}var xml2json=new XMLtoJSON;